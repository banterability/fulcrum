<!doctype html>
<html lang="en">
<head>
  <style>
    *, *:before, *:after {
      -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box;
     }
    .bug{background-color: rgba(255, 0, 0, 0.1);}
    .feature{background-color: rgba(0, 255, 0, 0.1);}
    .chore{background-color: rgba(255, 255, 0, 0.1);}
    .story-list{
      display: inline-block;
      vertical-align: top;
      border: 2px solid rgba(0,0,0,0.2);
      margin: 0 5px;
      padding: 5px;
    }
    ul{
      padding-left: 0;
      list-style-position: inside;
    }
    li:nth-child(1){font-size:1.1em;color:rgba(0,0,0,0.9);}
    li:nth-child(2){font-size:1.0em;color:rgba(0,0,0,0.7);}
    li{font-size:0.9em; color:rgba(0,0,0,0.5);}
  </style>
</head>
<body>

  <div id="main"></div>

  <script src="vendor/underscore-min.js"></script>
  <script src="vendor/backbone-min.js"></script>

  <script src="stub_api_response.json"></script>

  <script>
    var StoryModel, StoryCollection, stories;

    StoryModel = Backbone.Model.extend({});

    StoryCollection = Backbone.Collection.extend({
      model: StoryModel
    });

    stories = new StoryCollection;

    storyData.stories.forEach(function(story){
      stories.add({
        id: story.id,
        title: story.title,
        type: story.type,
        author: story.author.name,
        authorId: story.author.id
      });
    });
  </script>
  <script>
    var buildListForOwner, parentEl, storiesByAuthor;

    buildListForOwner = function(owner, stories){
      var container, header, list;
      container = document.createElement('div');
      container.classList.add('story-list');

      header = document.createElement('p');
      header.textContent = "" + owner + "'s Stories:";

      list = document.createElement('ul');
      stories.forEach(function(story){
        var listItem;
        listItem = document.createElement('li');
        listItem.classList.add(story.get('type'));
        listItem.textContent = story.get('title');
        list.appendChild(listItem);
      });

      container.appendChild(header);
      container.appendChild(list);

      return container;
    };

    parentEl = document.getElementById('main');

    storiesByAuthor = stories.groupBy('author');

    for (var property in storiesByAuthor){
      if (storiesByAuthor.hasOwnProperty(property)) {
        parentEl.appendChild(
          buildListForOwner(property, storiesByAuthor[property])
        );
      }
    }
  </script>
</body>
</html>